{% load static %}
{% load i18n %}

<!DOCTYPE html>
<html>
    <head><title>{% trans "Tendencias" %}</title>
        <link href='{% static "css/inicio.css" %}' rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Barlow:wght@400;700&display=swap">
        <link href='{% static "css/games.css" %}' rel="stylesheet" type="text/css">
        <link href='{% static "css/header.css" %}' rel="stylesheet" type="text/css">
        <link href='{% static "css/dialog.css" %}' rel="stylesheet" type="text/css">
        <link href='{% static "css/footer.css" %}' rel="stylesheet" type="text/css">
    </head>
    <body>
        <header class="firstHeader header">
            <div class="conendorImagenFondo">
                <picture class="imagenDeFondo">
                    <!--<img src="https://s2.best-wallpaper.net/wallpaper/3840x2160/1811/Red-Dead-Redemption-2-art-picture_3840x2160.jpg" alt="Texto alternativo">-->
                    <img src="https://www.warlegend.net/wp-content/uploads/Guide-du-d%C3%A9butant-Assassins-Creed-Valhalla.jpg" alt="Texto alternativo">
                    <!--<img src="https://www.xtrafondos.com/descargar.php?id=3380&resolucion=3840x2160" alt="Texto alternativo">-->
                </picture>
            </div>
            <a class="logoImg"></a>
            <div class="menu">
                <div class="firstMenu">
                    <a href="#">{% trans "Tendencias" %}</a>
                    <a href="#">{% trans "Reservas" %}</a>
                    <a href="#">{% trans "Proximos lanzamientos" %}</a>
                    <a href="#">{% trans "Soporte" %}</a>
                </div>
                <div class="secondMenu hidden">
                    <div class="items">
                        <div id="itemNav"><div class="pcIcon"></div><span>PC</span><div class="iconArrow"></div></div>
                        <div id="itemNav1"><div class="playIcon"></div><span>Playstation</span><div class="iconArrow"></div></div>
                        <div id="itemNav2"><div class="xboxIcon"></div><span>Xbox</span><div class="iconArrow"></div></div>
                        <div id="itemNav3"><div class="nintendoIcon"></div><span>Nintendo</span><div class="iconArrow"></div></div>
                    </div>
                </div>
            </div>
            <dialog id="dialog"><button id="closeDialogButton">CLOSE</button></dialog>
        </header>
        
        <main>
            <div class="mainContent">
                <div class="contentTendencias">
                    <h2>{% trans "Tendencias" %}</h2>
                </div>

                <div class="allGames">
                    {% if games %}
                    {% for game in games %}
                        <div class="gameContainer">
                            <a href="/game/{{ game.name }}">
                                <picture class="gamePicture">
                                    <img alt="{{ game.name }}" src="{{ game.image.url }}" loading="lazy" onload="lazyLoadImage(this)">
                                    <video class="trailer" src="https://bucketdjangopruebagameshop.s3.amazonaws.com/static/videos/AssassinTrailer.mp4" loop muted></video>
                                </picture>
                            </a>
                            <div class="titleGame"><span>{{game.name}}</span><span>{{game.price}}$</span></div>
                        </div>
                    {% endfor %}
            
                    {% else %}
                        <p>No gammes</p>
                    {% endif %}

                    <div class="gameContainer">
                        <a href="/game/{{ game.name }}">
                            <picture class="gamePicture">
                                <img data-src="https://gaming-cdn.com/images/products/13288/380x218/remnant-2-pc-juego-steam-cover.jpg?v=1690639200" alt="Remnant 2" src="https://gaming-cdn.com/images/products/13288/380x218/remnant-2-pc-juego-steam-cover.jpg?v=1690639200" loading="lazy" onload="lazyLoadImage(this)">      
                                <video class="trailer" src="/static/videos/AssassinTrailer.mp4" loop muted></video>
                            </picture>
                        </a>
                        <div class="titleGame"><span>Remnant 2</span><span>36.49$</span></div>
                    </div>
                    <div class="gameContainer">
                        <picture class="gamePicture">
                            <img class="picture" data-src="https://gaming-cdn.com/images/products/9665/380x218/ratchet-clank-rift-apart-pc-juego-steam-europe-cover.jpg?v=1690642800" alt="Ratchet &amp; Clank Rift Apart" src="https://gaming-cdn.com/images/products/9665/380x218/ratchet-clank-rift-apart-pc-juego-steam-europe-cover.jpg?v=1690642800" loading="lazy" onload="lazyLoadImage(this)">
                            <video class="trailer" src="/static/videos/AssassinTrailer.mp4" loop muted></video>
                        </picture>
                        <div class="titleGame"><span>Remnant 2</span><span>36.49$</span></div>
                    </div>
                    <div class="gameContainer">
                        <picture class="gamePicture">
                            <img class="picture" data-src="https://gaming-cdn.com/images/products/9665/380x218/ratchet-clank-rift-apart-pc-juego-steam-europe-cover.jpg?v=1690642800" alt="Ratchet &amp; Clank Rift Apart" src="https://gaming-cdn.com/images/products/9665/380x218/ratchet-clank-rift-apart-pc-juego-steam-europe-cover.jpg?v=1690642800" loading="lazy" onload="lazyLoadImage(this)">
                        </picture>
                        <div class="titleGame"><span>Remnant 2</span><span>36.49$</span></div>
                    </div>
                    <div class="gameContainer">
                        <picture class="gamePicture">
                            <img class="picture" data-src="https://gaming-cdn.com/images/products/9665/380x218/ratchet-clank-rift-apart-pc-juego-steam-europe-cover.jpg?v=1690642800" alt="Ratchet &amp; Clank Rift Apart" src="https://gaming-cdn.com/images/products/9665/380x218/ratchet-clank-rift-apart-pc-juego-steam-europe-cover.jpg?v=1690642800" loading="lazy" onload="lazyLoadImage(this)">
                        </picture>
                        <div class="titleGame"><span>Remnant 2</span><span>36.49$</span></div>
                    </div>
                    <div class="gameContainer">
                        <picture class="gamePicture">
                            <img class="picture" data-src="https://gaming-cdn.com/images/products/9665/380x218/ratchet-clank-rift-apart-pc-juego-steam-europe-cover.jpg?v=1690642800" alt="Ratchet &amp; Clank Rift Apart" src="https://gaming-cdn.com/images/products/9665/380x218/ratchet-clank-rift-apart-pc-juego-steam-europe-cover.jpg?v=1690642800" loading="lazy" onload="lazyLoadImage(this)">
                        </picture>
                        <div class="titleGame"><span>Remnant 2</span><span>36.49$</span></div>
                    </div>
                </div>
            </div>
            <div id="accordeonImg">
                <div class="accordeonContent">
                    <img src="https://s2.best-wallpaper.net/wallpaper/3840x2160/1811/Red-Dead-Redemption-2-art-picture_3840x2160.jpg" alt="Texto alternativo">
                </div>
                <div class="accordeonContent">
                    <img src="https://www.warlegend.net/wp-content/uploads/Guide-du-d%C3%A9butant-Assassins-Creed-Valhalla.jpg" alt="Texto alternativo">
                </div>
                <div class="accordeonContent">
                    <img src="https://www.xtrafondos.com/descargar.php?id=2068&resolucion=1920x1200" alt="Texto alternativo">
                </div>
                <div class="accordeonContent">
                    <img src="https://cdn1.epicgames.com/offer/e97659b501af4e3981d5430dad170911/EGS_HogwartsLegacy_AvalancheSoftware_S1_2560x1440-2baf3188eb3c1aa248bcc1af6a927b7e" alt="Texto alternativo">                
                </div>
                <div class="accordeonContent">
                    <img src="https://blog.es.playstation.com/tachyon/sites/14/2022/06/adf0c6e3da060a9f9581c12eff047a48668fe616.jpg" alt="Texto alternativo">                
                </div>
            </div>
        </main>
        <footer>
            <div class="contentFooter">
                <div class="topFooter">
                    <div class="iconFooterContent">
                        <div class="footerIconImg">
                            <img src="https://www.instant-gaming.com/themes/igv2/images/logos/horizontal-orange.svg" alt="Texto alternativo">                
                        </div>
                        <div class="footerStarIcon">
                            <img src="https://www.instant-gaming.com/themes/igv2/images/trustpilot-logo.svg" alt="Texto alternativo">                
                        </div>                
                    </div>
                    <div class="buttonsFooter">
                        <div class="contentFooterButtons">
                            <button>Términos y condiciones</button>
                            <button>Política de privacidad</button>
                            <button>Contacto</button>
                            <button>FAQ</button>
                        </div>
                    </div>
                    <div>
                        
                    </div>
                </div>

                <div id="rightsFooter">
                    <div class="rightReservedFooter">
                        <span>Copyright © 2023 Instant Gaming - All rights reserved</span>
                    </div>
                    <div class="rightReservedFooter">
                        <form action="{% url 'set_language' %}" method="post" id="language-form">
                            {% csrf_token %}
                            <select name="language" id="language-selector" onchange=submitForm()>
                                {% get_available_languages as languages %}
                                {% get_current_language as current_language %}
                                {% for lang_code, lang_name in languages %}
                                <option value="{{ lang_code }}" {% if lang_code == current_language %}selected{% endif %}>{{ lang_name }}</option>
                                {% endfor %}
                            </select>
                        </form>
                    </div>
                </div>
            </div>

        </footer>
    </body>
    <script>
        const secondMenuDiv = document.querySelector('.hidden');
        const headerElement = document.querySelector('.header');

        window.addEventListener('scroll', function() {
            if (window.scrollY > 50) {
                secondMenuDiv.classList.add('firstMenuScrolled');
                secondMenuDiv.classList.remove('secondMenu');
                hideElementsWithClass('.firstMenu');
                headerElement.classList.add('secondHeader');
                headerElement.classList.remove('firstHeader');
            } 
            else {
                secondMenuDiv.classList.remove('firstMenuScrolled');
                secondMenuDiv.classList.add('secondMenu');
                showElementsWithClass('.firstMenu');
                headerElement.classList.remove('secondHeader');
                headerElement.classList.add('firstHeader');
            }
        });

        
        function hideElementsWithClass(className) {
            const elements = document.querySelectorAll(className);
            elements.forEach((element) => {
                element.style.display = 'none';
            });
        }

        function showElementsWithClass(className) {
            const elements = document.querySelectorAll(className);
            elements.forEach((element) => {
                element.style.display = ''; // Restore default display property
            });
        }

        function submitForm(){
            const form = document.getElementById('language-form');
            form.submit();
        }
    </script>
    <script>
        const closeDialog = document.getElementById('closeDialogButton');
        const dialog = document.getElementById('dialog');
        const xboxDialog = document.getElementById('itemNav');
        const xboxDialog1 = document.getElementById('itemNav1');
        const xboxDialog2 = document.getElementById('itemNav2');
        const xboxDialog3 = document.getElementById('itemNav3');
        
        xboxDialog.addEventListener('click', function() {
            openDialog();
            enableDialogElements();
            document.addEventListener('mousemove', mouseMoveHandler);
        });
        xboxDialog1.addEventListener('click', openDialog);
        xboxDialog2.addEventListener('click', openDialog);
        xboxDialog3.addEventListener('click', openDialog);

        closeDialog.addEventListener('click', function(){
            dialog.close();
        })
        function openDialog(){
            dialog.showModal();
        }
        function enableDialogElements(){
            
        }
        function mouseMoveHandler(event) {
            const dialogRect = dialog.getBoundingClientRect();
            const mouseX = event.clientX;
            const mouseY = event.clientY;

            const expandedLeft = dialogRect.left - 100;
            const expandedRight = dialogRect.right + 100;
            const expandedTop = dialogRect.top - 100;
            const expandedBottom = dialogRect.bottom + 100;

            if (
                mouseX < expandedLeft ||
                mouseX > expandedRight ||
                mouseY < expandedTop ||
                mouseY > expandedBottom
            ) {
                dialog.close();
            }
        }
        
    </script>
    <script>
        const juegos = document.querySelectorAll('.gamePicture');

        juegos.forEach((juego) => {
            const img = juego.querySelector('img');
            const video = juego.querySelector('video');

            juego.addEventListener('mouseenter', () => {
                setTimeout(() => {
                    video.style.display = 'block';
                    video.play();
                }, 500);
            });
            juego.addEventListener('mouseleave', () => {
                video.style.display = 'none';
                video.pause();
            });
        });
    </script>
</html>